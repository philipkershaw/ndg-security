<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ndg-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >NDG Security</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ndg-module.html">Package&nbsp;ndg</a> ::
        <a href="ndg.security-module.html">Package&nbsp;security</a> ::
        <a href="ndg.security.common-module.html">Package&nbsp;common</a> ::
        <a href="ndg.security.common.SecurityCGI-module.html">Module&nbsp;SecurityCGI</a> ::
        Class&nbsp;ServiceProviderSecurityCGI
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class ServiceProviderSecurityCGI</h1><p class="nomargin-top"><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI">source&nbsp;code</a></span></p>
<center>
<center>  <map id="uml_class_diagram_for_ndg_secu_52" name="uml_class_diagram_for_ndg_secu_52">
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#returnURItag" title="ndg.security.common.SecurityCGI._SecurityCGI.returnURItag" alt="" coords="607,396,876,414"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acAllowMapping" title="ndg.security.common.SecurityCGI._SecurityCGI.acAllowMapping" alt="" coords="607,414,876,433"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acAllowMappingWithPrompt" title="ndg.security.common.SecurityCGI._SecurityCGI.acAllowMappingWithPrompt" alt="" coords="607,433,876,452"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acNoMapping" title="ndg.security.common.SecurityCGI._SecurityCGI.acNoMapping" alt="" coords="607,452,876,470"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acMappingFlags" title="ndg.security.common.SecurityCGI._SecurityCGI.acMappingFlags" alt="" coords="607,470,876,489"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acMappingFlag" title="ndg.security.common.SecurityCGI._SecurityCGI.acMappingFlag" alt="" coords="607,489,876,508"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#__call__" title="Alias to processFields method" alt="" coords="607,510,876,529"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#onAttCertGranted" title="Callback invoked by getAttCert &#45; handle case where an Attribute Authority &#160;has granted a new attribute certificate to the user." alt="" coords="607,529,876,548"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#onAttCertDenied" title="Callback invoked by getAttCert &#45; handle case where an Attribute Authority has denied an attribute certificate to the user." alt="" coords="607,548,876,566"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html" title="CGI Service Provider &#45; Identity Provider interface base class for NDG Security" alt="" coords="605,378,877,568"/>
<area shape="rect" href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI&#45;class.html#requestURItag" title="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI.requestURItag" alt="" coords="17,614,1465,633"/>
<area shape="rect" href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI&#45;class.html#__init__" title="scriptName: &#160;&#160;&#160;&#160;&#160;&#160;&#160;Name of the script that uses this code." alt="" coords="17,636,1465,654"/>
<area shape="rect" href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI&#45;class.html#processFields" title="Call appropriate actions according to the fields set" alt="" coords="17,654,1465,673"/>
<area shape="rect" href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI&#45;class.html#showIdPsiteSelect" title="Display a list of Identity Provider sites for the user to select to &#160;retrieve their credentials." alt="" coords="17,673,1465,692"/>
<area shape="rect" href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI&#45;class.html#onCredsSet" title="This method is called when either:" alt="" coords="17,692,1465,710"/>
<area shape="rect" href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI&#45;class.html#getTrustedIdPs" title="Call Attribute Authority to find out IdPs that this SP trusts." alt="" coords="17,710,1465,729"/>
<area shape="rect" href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI&#45;class.html" title="CGI interface for a Service Provider requesting user credentials" alt="" coords="16,597,1467,730"/>
<area shape="rect" href="javascript:void(0);" title="cgi.FieldStorage.FieldStorageClass" alt="" coords="563,28,920,46"/>
<area shape="rect" href="javascript:void(0);" title="cgi.FieldStorage.bufsize" alt="" coords="563,46,920,65"/>
<area shape="rect" href="javascript:void(0);" title="cgi.FieldStorage.__iter__" alt="" coords="563,68,920,86"/>
<area shape="rect" href="javascript:void(0);" title="cgi.FieldStorage.__getattr__" alt="" coords="563,86,920,105"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style indexing." alt="" coords="563,105,920,124"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style get() method, including &#39;value&#39; lookup." alt="" coords="563,124,920,142"/>
<area shape="rect" href="javascript:void(0);" title="Return the first value received." alt="" coords="563,142,920,161"/>
<area shape="rect" href="javascript:void(0);" title="Return list of received values." alt="" coords="563,161,920,180"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style keys() method." alt="" coords="563,180,920,198"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style has_key() method." alt="" coords="563,198,920,217"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style __contains__ method." alt="" coords="563,217,920,236"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style len(x) support." alt="" coords="563,236,920,254"/>
<area shape="rect" href="javascript:void(0);" title="Internal: read data in query string format." alt="" coords="563,254,920,273"/>
<area shape="rect" href="javascript:void(0);" title="Internal: read a part that is itself multipart." alt="" coords="563,273,920,292"/>
<area shape="rect" href="javascript:void(0);" title="Internal: read an atomic part." alt="" coords="563,292,920,310"/>
<area shape="rect" href="javascript:void(0);" title="Overridable: return a readable &amp; writable file." alt="" coords="563,329,920,348"/>
<area shape="rect" href="javascript:void(0);" title="Store a sequence of fields, reading multipart/form&#45;data." alt="" coords="561,10,921,349"/>
</map>
  <img src="uml_class_diagram_for_ndg_secu_52.gif" alt='' usemap="#uml_class_diagram_for_ndg_secu_52" ismap="ismap" class="graph-without-title" />
</center>
</center>
<hr />
<p>CGI interface for a Service Provider requesting user credentials</p>
  <p>It enables the user to select an Identity Provider login page from a 
  list of trusted hosts, re-directs the user browser to the login and then 
  can process credentials passed back from the IdP to enable a new NDG 
  security cookie to be set in the Service Provider target domain.</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">scriptName</span>,
        <span class="summary-sig-arg">returnURI</span>,
        <span class="summary-sig-arg">aaWSDLuri</span>,
        <span class="summary-sig-arg">aaCertFilePath</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">smWSDLuri</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">smCertFilePath</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">trustedIdPs</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">cookieLifetimeHrs</span>=<span class="summary-sig-default">8</span>,
        <span class="summary-sig-arg">**securityCGIKwArgs</span>)</span><br />
      scriptName:        Name of the script that uses this code.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.__init__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI-class.html#processFields" class="summary-sig-name">processFields</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Call appropriate actions according to the fields set</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.processFields">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI-class.html#showIdPsiteSelect" class="summary-sig-name">showIdPsiteSelect</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">trustedIdPs</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">scriptName</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">contentTypeHdr</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">htmlTag</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">hdrTag</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">hdrTxt</span>=<span class="summary-sig-default">_defStyle</span>,
        <span class="summary-sig-arg">bodyTag</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">bodyTxt</span>=<span class="summary-sig-default">&quot;&lt;h2&gt;Security Credentials are Required&lt;/h2&gt;&quot;</span>,
        <span class="summary-sig-arg">pageTitle</span>=<span class="summary-sig-default">&quot;Select your home site ...&quot;</span>)</span><br />
      Display a list of Identity Provider sites for the user to select to 
      retrieve their credentials.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.showIdPsiteSelect">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI-class.html#onCredsSet" class="summary-sig-name">onCredsSet</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">sessCookie</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">pageTitle</span>=<span class="summary-sig-default">'Credentials Set'</span>,
        <span class="summary-sig-arg">hdrTxt</span>=<span class="summary-sig-default">_defStyle</span>,
        <span class="summary-sig-arg">bodyTxt</span>=<span class="summary-sig-default">'&lt;h2&gt;NDG Security session cookie set&lt;/h2&gt;'</span>)</span><br />
      This method is called when either:</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.onCredsSet">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI-class.html#getTrustedIdPs" class="summary-sig-name">getTrustedIdPs</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Call Attribute Authority to find out IdPs that this SP trusts.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.getTrustedIdPs">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_createCookie"></a><span class="summary-sig-name">_createCookie</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">encodedExpiry</span>=<span class="summary-sig-default">None</span>)</span><br />
      Convert credentials passed over URI from users Identity Provider into
      a new cookie</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI._createCookie">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI.ServiceProviderSecurityCGI-class.html#_requestCreds" class="summary-sig-name" onclick="show_private();">_requestCreds</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">requestURI</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">pageTitle</span>=<span class="summary-sig-default">''</span>,
        <span class="summary-sig-arg">headTags</span>=<span class="summary-sig-default">''</span>,
        <span class="summary-sig-arg">delayTime</span>=<span class="summary-sig-default">0</span>,
        <span class="summary-sig-arg">redirectMsg</span>=<span class="summary-sig-default">''</span>)</span><br />
      Request credentials from a user's Identity Provider</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI._requestCreds">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_receiveCredsResponse"></a><span class="summary-sig-name">_receiveCredsResponse</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">encodedExpiry</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Service Provider site receives returned credentials and creates a new
      cookie for its domain</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI._receiveCredsResponse">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html" onclick="show_private();">_SecurityCGI</a></code></b>:
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#__call__">__call__</a></code>,
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#onAttCertDenied">onAttCertDenied</a></code>,
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#onAttCertGranted">onAttCertGranted</a></code>
      </p>
    <div class="private">    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html" onclick="show_private();">_SecurityCGI</a></code></b> (private):
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#_getAttCert" onclick="show_private();">_getAttCert</a></code>
      </p></div>
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__delattr__</code>,
      <code>__getattribute__</code>,
      <code>__hash__</code>,
      <code>__new__</code>,
      <code>__reduce__</code>,
      <code>__reduce_ex__</code>,
      <code>__repr__</code>,
      <code>__setattr__</code>,
      <code>__str__</code>
      </p>
    <p class="indent-wrapped-lines"><b>Inherited from <code>cgi.FieldStorage</code></b>:
      <code>__contains__</code>,
      <code>__getattr__</code>,
      <code>__getitem__</code>,
      <code>__iter__</code>,
      <code>__len__</code>,
      <code>getfirst</code>,
      <code>getlist</code>,
      <code>getvalue</code>,
      <code>has_key</code>,
      <code>keys</code>,
      <code>make_file</code>,
      <code>read_binary</code>,
      <code>read_lines</code>,
      <code>read_lines_to_eof</code>,
      <code>read_lines_to_outerboundary</code>,
      <code>read_multi</code>,
      <code>read_single</code>,
      <code>read_urlencoded</code>,
      <code>skip_lines</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== CLASS VARIABLES ==================== -->
<a name="section-ClassVariables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Class Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-ClassVariables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="requestURItag"></a><span class="summary-name">requestURItag</span> = <code title="'requestURI'">'requestURI'</code>
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html" onclick="show_private();">_SecurityCGI</a></code></b>:
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#acAllowMapping">acAllowMapping</a></code>,
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#acAllowMappingWithPrompt">acAllowMappingWithPrompt</a></code>,
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#acMappingFlag">acMappingFlag</a></code>,
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#acMappingFlags">acMappingFlags</a></code>,
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#acNoMapping">acNoMapping</a></code>,
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#returnURItag">returnURItag</a></code>
      </p>
    <div class="private">    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html" onclick="show_private();">_SecurityCGI</a></code></b> (private):
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#_httpSpecifier" onclick="show_private();">_httpSpecifier</a></code>,
      <code><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#_httpsSpecifier" onclick="show_private();">_httpsSpecifier</a></code>
      </p></div>
    <p class="indent-wrapped-lines"><b>Inherited from <code>cgi.FieldStorage</code></b>:
      <code>FieldStorageClass</code>,
      <code>bufsize</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__class__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">scriptName</span>,
        <span class="sig-arg">returnURI</span>,
        <span class="sig-arg">aaWSDLuri</span>,
        <span class="sig-arg">aaCertFilePath</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">smWSDLuri</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">smCertFilePath</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">trustedIdPs</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">cookieLifetimeHrs</span>=<span class="sig-default">8</span>,
        <span class="sig-arg">**securityCGIKwArgs</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.__init__">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
scriptName:        Name of the script that uses this code.  It's
                      needed as the action of the HTML form for
                      showIdPsiteSelect to ensure that it can call
                      _requestCreds()
returnURI:            Specifies the URI that the IdP selected by the
                      user should redirect back to once the user's
                      credentials have been obtained.  - Used by
                      _requestCreds.
aaWSDLuri:            URI for Attribute Authority WSDL used to get a
                      list of login URI for trusted hosts
smWSDLuri:            URI For Session Manager WSDL used for querying
                      user session wallet for Attribute Certificates.
                      Only needed for _getAttCert calls
aaCertFilePath:     file path to Attribute Authority public key.
                      If not set, the client will make a WS call for
                      it.
smCertFilePath:     file path to Session Manager public key.
                      If not set, the client will make a WS call for
                      it.  See information for smWSDLuri above.
trustedIdPs:          dictionary of URIs for trusted hosts indexed by
                      hostname
cookieLifetimeHrs:    cookie lifetime in hours for new cookie set in
                      Service Provider target domain.
wsDebug:              print output from WS transactions to stderr

</pre>
  <dl class="fields">
    <dt>Overrides:
        cgi.FieldStorage.__init__
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="processFields"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">processFields</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.processFields">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Call appropriate actions according to the fields set</p>
  <dl class="fields">
    <dt>Overrides:
        <a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#processFields">_SecurityCGI.processFields</a>
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="showIdPsiteSelect"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">showIdPsiteSelect</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">trustedIdPs</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">scriptName</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">contentTypeHdr</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">htmlTag</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">hdrTag</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">hdrTxt</span>=<span class="sig-default">_defStyle</span>,
        <span class="sig-arg">bodyTag</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">bodyTxt</span>=<span class="sig-default">&quot;&lt;h2&gt;Security Credentials are Required&lt;/h2&gt;&quot;</span>,
        <span class="sig-arg">pageTitle</span>=<span class="sig-default">&quot;Select your home site ...&quot;</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.showIdPsiteSelect">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Display a list of Identity Provider sites for the user to select to 
  retrieve their credentials.  The user must have an account with one of 
  these sites in order to be able to proceed</p>
  <p>Override this method as required for custom IdP page presentation. 
  However, the following field must be set:</p>
  <p>ServiceProviderSecurityCGI.requestURItag</p>
  <p>This is the URI of the IdP login the user selected</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="onCredsSet"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">onCredsSet</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">sessCookie</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">pageTitle</span>=<span class="sig-default">'Credentials Set'</span>,
        <span class="sig-arg">hdrTxt</span>=<span class="sig-default">_defStyle</span>,
        <span class="sig-arg">bodyTxt</span>=<span class="sig-default">'&lt;h2&gt;NDG Security session cookie set&lt;/h2&gt;'</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.onCredsSet">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
This method is called when either:

a) a user security cookie is already present in the Service 
Provider URI's environment.

or 

b) a new cookie has been created from credentials returned from an
Identity Provider.

For b) this method should set the cookie in HTML sent to user's 
browser.

This method can be overridden by a derived class.  From this point
on, the user is authenticated and a connection has been established to
their session manager so the authorisation steps to set up access to
a secured resource can now proceed.  Code in this method can initiate 
these next steps.

Nb. If SP and IdP are in the same domain sessCookie will not be
set when the user authenticates because the cookie set at the 
IdP login URI will be visible from the SP return URI as well.

sessCookie:    NDG Security Cookie passed as a SimpleCookie type.  If
               set, this method should set it in HTML output so that
               it is transfered to the user's browser.
pageTitle:     set a page title for the page output.
hdTxt:         set HTML within &lt;head&gt;...&lt;/head&gt;
bodyTxt:       set HTML within &lt;body&gt;...&lt;/body&gt;

pageTitle, hdrTxt and BodyTxt can be ignored completely in a method of
a derived class if required.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="getTrustedIdPs"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">getTrustedIdPs</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI.getTrustedIdPs">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Call Attribute Authority to find out IdPs that this SP trusts. i.e. 
  the SP's Attribute Authority includes them in it's map configuration.  
  These can be use to populate list for a user to select their Identity 
  Provider for login</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_requestCreds"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_requestCreds</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">requestURI</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">pageTitle</span>=<span class="sig-default">''</span>,
        <span class="sig-arg">headTags</span>=<span class="sig-default">''</span>,
        <span class="sig-arg">delayTime</span>=<span class="sig-default">0</span>,
        <span class="sig-arg">redirectMsg</span>=<span class="sig-default">''</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#ServiceProviderSecurityCGI._requestCreds">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Request credentials from a user's Identity Provider

requestURI:   site to request credentials from - default is 
              self.requestURItag CGI form value
pageTitle:    Give the redirect page a title
headTags:     Optionally add additional tags in &lt;head/&gt; section
delayTime:    time in seconds before carrying out redirect - redirect
              page will be displayed in this interval
redirectMsg:  Message to put on redirect page.  Can be plain text or
              formatted HTML

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ndg-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >NDG Security</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    <a href="epydoc-log.html">Generated by Epydoc
    3.0.1 on Thu Sep  4 09:37:43 2008</a>
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
