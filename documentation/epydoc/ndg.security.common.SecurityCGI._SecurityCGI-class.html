<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ndg.security.common.SecurityCGI._SecurityCGI</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ndg-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >NDG Security</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ndg-module.html">Package&nbsp;ndg</a> ::
        <a href="ndg.security-module.html">Package&nbsp;security</a> ::
        <a href="ndg.security.common-module.html">Package&nbsp;common</a> ::
        <a href="ndg.security.common.SecurityCGI-module.html">Module&nbsp;SecurityCGI</a> ::
        Class&nbsp;_SecurityCGI
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class _SecurityCGI</h1><p class="nomargin-top"><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI">source&nbsp;code</a></span></p>
<center>
<center>  <map id="uml_class_diagram_for_ndg_secu_53" name="uml_class_diagram_for_ndg_secu_53">
<area shape="rect" href="javascript:void(0);" title="cgi.FieldStorage.FieldStorageClass" alt="" coords="263,28,620,47"/>
<area shape="rect" href="javascript:void(0);" title="cgi.FieldStorage.bufsize" alt="" coords="263,47,620,65"/>
<area shape="rect" href="javascript:void(0);" title="cgi.FieldStorage.__iter__" alt="" coords="263,68,620,87"/>
<area shape="rect" href="javascript:void(0);" title="cgi.FieldStorage.__getattr__" alt="" coords="263,87,620,105"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style indexing." alt="" coords="263,105,620,124"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style get() method, including &#39;value&#39; lookup." alt="" coords="263,124,620,143"/>
<area shape="rect" href="javascript:void(0);" title="Return the first value received." alt="" coords="263,143,620,161"/>
<area shape="rect" href="javascript:void(0);" title="Return list of received values." alt="" coords="263,161,620,180"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style keys() method." alt="" coords="263,180,620,199"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style has_key() method." alt="" coords="263,199,620,217"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style __contains__ method." alt="" coords="263,217,620,236"/>
<area shape="rect" href="javascript:void(0);" title="Dictionary style len(x) support." alt="" coords="263,236,620,255"/>
<area shape="rect" href="javascript:void(0);" title="Internal: read data in query string format." alt="" coords="263,255,620,273"/>
<area shape="rect" href="javascript:void(0);" title="Internal: read a part that is itself multipart." alt="" coords="263,273,620,292"/>
<area shape="rect" href="javascript:void(0);" title="Internal: read an atomic part." alt="" coords="263,292,620,311"/>
<area shape="rect" href="javascript:void(0);" title="Overridable: return a readable &amp; writable file." alt="" coords="263,329,620,348"/>
<area shape="rect" href="javascript:void(0);" title="Store a sequence of fields, reading multipart/form&#45;data." alt="" coords="261,11,621,349"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#returnURItag" title="ndg.security.common.SecurityCGI._SecurityCGI.returnURItag" alt="" coords="17,396,865,415"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acAllowMapping" title="ndg.security.common.SecurityCGI._SecurityCGI.acAllowMapping" alt="" coords="17,415,865,433"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acAllowMappingWithPrompt" title="ndg.security.common.SecurityCGI._SecurityCGI.acAllowMappingWithPrompt" alt="" coords="17,433,865,452"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acNoMapping" title="ndg.security.common.SecurityCGI._SecurityCGI.acNoMapping" alt="" coords="17,452,865,471"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acMappingFlags" title="ndg.security.common.SecurityCGI._SecurityCGI.acMappingFlags" alt="" coords="17,471,865,489"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#acMappingFlag" title="ndg.security.common.SecurityCGI._SecurityCGI.acMappingFlag" alt="" coords="17,489,865,508"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#__init__" title="scriptName: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Name of IdP script specified as the action &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for HTML forms clntCertFilePath: &#160;&#160;&#160;file path to client public key." alt="" coords="17,511,865,529"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#processFields" title="Call appropriate actions according to the fields set" alt="" coords="17,529,865,548"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#__call__" title="Alias to processFields method" alt="" coords="17,548,865,567"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#onAttCertGranted" title="Callback invoked by getAttCert &#45; handle case where an Attribute Authority &#160;has granted a new attribute certificate to the user." alt="" coords="17,567,865,585"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html#onAttCertDenied" title="Callback invoked by getAttCert &#45; handle case where an Attribute Authority has denied an attribute certificate to the user." alt="" coords="17,585,865,604"/>
<area shape="rect" href="ndg.security.common.SecurityCGI._SecurityCGI&#45;class.html" title="CGI Service Provider &#45; Identity Provider interface base class for NDG Security" alt="" coords="16,379,867,605"/>
</map>
  <img src="uml_class_diagram_for_ndg_secu_53.gif" alt='' usemap="#uml_class_diagram_for_ndg_secu_53" ismap="ismap" class="graph-without-title" />
</center>
</center>
<hr />
<pre class="literalblock">
CGI Service Provider - Identity Provider interface base class for NDG 
Security

Service Provider (SP)    - serves NDG resources over http/https
Identity Provider (IdP)  - holds NDG user accounts and supports 
                           authentication over https

</pre>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">scriptName</span>,
        <span class="summary-sig-arg">clntCertFilePath</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">clntPriKeyFilePath</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">clntPriKeyPwd</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">wsDebug</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">**cgiFieldStorageKwArgs</span>)</span><br />
      scriptName:            Name of IdP script specified as the action
                          for HTML forms
clntCertFilePath:    file path to client public key.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.__init__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="processFields"></a><span class="summary-sig-name">processFields</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Call appropriate actions according to the fields set</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.processFields">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__call__"></a><span class="summary-sig-name">__call__</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Alias to processFields method</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.__call__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__getACmappingFlag"></a><span class="summary-sig-name">__getACmappingFlag</span>(<span class="summary-sig-arg">self</span>)</span><br />
      Flag determines whether mapping is permitted when contacting an 
      Attribute Authority to get an Attribute Certificate</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.__getACmappingFlag">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__setACmappingFlag"></a><span class="summary-sig-name">__setACmappingFlag</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">acMappingFlag</span>)</span><br />
      Flag determines whether mapping is permitted when contacting an 
      Attribute Authority to get an Attribute Certificate</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.__setACmappingFlag">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__delACmappingFlag"></a><span class="summary-sig-name">__delACmappingFlag</span>(<span class="summary-sig-arg">self</span>)</span><br />
      Prevent certificate mapping flag from being deleted.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.__delACmappingFlag">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#_getAttCert" class="summary-sig-name" onclick="show_private();">_getAttCert</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">sessCookie</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">reqRole</span>=<span class="summary-sig-default">None</span>)</span><br />
      Contact Attribute Authority to get Attribute Certificate for data
access</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI._getAttCert">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#onAttCertGranted" class="summary-sig-name">onAttCertGranted</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">attCert</span>)</span><br />
      Callback invoked by getAttCert - handle case where an Attribute 
      Authority has granted a new attribute certificate to the user.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.onAttCertGranted">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#onAttCertDenied" class="summary-sig-name">onAttCertDenied</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">extAttCertList</span>,
        <span class="summary-sig-arg">errMsg</span>)</span><br />
      Callback invoked by getAttCert - handle case where an Attribute
Authority has denied an attribute certificate to the user.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.onAttCertDenied">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__delattr__</code>,
      <code>__getattribute__</code>,
      <code>__hash__</code>,
      <code>__new__</code>,
      <code>__reduce__</code>,
      <code>__reduce_ex__</code>,
      <code>__repr__</code>,
      <code>__setattr__</code>,
      <code>__str__</code>
      </p>
    <p class="indent-wrapped-lines"><b>Inherited from <code>cgi.FieldStorage</code></b>:
      <code>__contains__</code>,
      <code>__getattr__</code>,
      <code>__getitem__</code>,
      <code>__iter__</code>,
      <code>__len__</code>,
      <code>getfirst</code>,
      <code>getlist</code>,
      <code>getvalue</code>,
      <code>has_key</code>,
      <code>keys</code>,
      <code>make_file</code>,
      <code>read_binary</code>,
      <code>read_lines</code>,
      <code>read_lines_to_eof</code>,
      <code>read_lines_to_outerboundary</code>,
      <code>read_multi</code>,
      <code>read_single</code>,
      <code>read_urlencoded</code>,
      <code>skip_lines</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== CLASS VARIABLES ==================== -->
<a name="section-ClassVariables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Class Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-ClassVariables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="returnURItag"></a><span class="summary-name">returnURItag</span> = <code title="&quot;returnURI&quot;">&quot;returnURI&quot;</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="acAllowMapping"></a><span class="summary-name">acAllowMapping</span> = <code title="&quot;allowMapping&quot;">&quot;allowMapping&quot;</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="acAllowMappingWithPrompt"></a><span class="summary-name">acAllowMappingWithPrompt</span> = <code title="&quot;allowMappingWithPrompt&quot;">&quot;allowMappingWithPrompt&quot;</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="acNoMapping"></a><span class="summary-name">acNoMapping</span> = <code title="&quot;noMapping&quot;">&quot;noMapping&quot;</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#acMappingFlags" class="summary-name">acMappingFlags</a> = <code title="[acAllowMapping, acAllowMappingWithPrompt, acNoMapping]">[acAllowMapping, acAllowMappingWithPrompt, ac<code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="_httpsSpecifier"></a><span class="summary-name">_httpsSpecifier</span> = <code title="&quot;https:&quot;">&quot;https:&quot;</code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="_httpSpecifier"></a><span class="summary-name">_httpSpecifier</span> = <code title="&quot;http:&quot;">&quot;http:&quot;</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ndg.security.common.SecurityCGI._SecurityCGI-class.html#acMappingFlag" class="summary-name">acMappingFlag</a> = <code title="property(fget= __getACmappingFlag, fset= __setACmappingFlag, fdel= __d\
elACmappingFlag, doc= &quot;mapping flag for AttCert requests to an AA&quot;)">property(fget= __getACmappingFlag, fset= __set<code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>cgi.FieldStorage</code></b>:
      <code>FieldStorageClass</code>,
      <code>bufsize</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__class__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">scriptName</span>,
        <span class="sig-arg">clntCertFilePath</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">clntPriKeyFilePath</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">clntPriKeyPwd</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">wsDebug</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">**cgiFieldStorageKwArgs</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.__init__">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
scriptName:            Name of IdP script specified as the action
                          for HTML forms
clntCertFilePath:    file path to client public key.  The CGI
                          script must have access to a public/private
                          key to enable encryption of return traffic
                          from NDG security WSs.  IF THIS KEYWORD IS
                          NOT SET, RETURN TRAFFIC IS NOT ENCRYPTED.
clntPriKeyFilePath:       file path to client private key.
clntPriKeyPwd:            password protecting the private key.  If no 
                          password is set, omit this keyword.
wsDebug:                  print output from WS transactions to stderr
                          for debu purposes.

</pre>
  <dl class="fields">
    <dt>Overrides:
        cgi.FieldStorage.__init__
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="_getAttCert"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_getAttCert</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">sessCookie</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">reqRole</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI._getAttCert">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Contact Attribute Authority to get Attribute Certificate for data
access

sessCookie:     NDG security session cookie
reqRole:        specify the required role to get authorisation.  Set
                this to optimise the process for getting the required
                AC from a trusted host in order to perform mapping

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="onAttCertGranted"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">onAttCertGranted</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">attCert</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.onAttCertGranted">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Callback invoked by getAttCert - handle case where an Attribute 
  Authority has granted a new attribute certificate to the user.  Derive 
  from this class and override this method as required.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="onAttCertDenied"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">onAttCertDenied</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">extAttCertList</span>,
        <span class="sig-arg">errMsg</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ndg.security.common.SecurityCGI-pysrc.html#_SecurityCGI.onAttCertDenied">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Callback invoked by getAttCert - handle case where an Attribute
Authority has denied an attribute certificate to the user.  Derive
from this class and override this method as required.

extAttCertList:    a list of attribute certificates from trusted
                   hosts.  Any of these could be selected and 
                   presented back to the target AA in order to get
                   a mapped certificate.  This list may be None if 
                   no ACs could be obtained or if the 
                   mapFromTrustedHosts flag in the call to the Session
                   Manager WS reqAuthorisation method was set to 
                   False.
                   
errMsg:            the error message returned from the call to the
                   AA to get an AC.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== CLASS VARIABLE DETAILS ==================== -->
<a name="section-ClassVariableDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Class Variable Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-ClassVariableDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="acMappingFlags"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">acMappingFlags</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
[acAllowMapping, acAllowMappingWithPrompt, acNoMapping]
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<a name="acMappingFlag"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">acMappingFlag</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
property(fget= __getACmappingFlag, fset= __setACmappingFlag, fdel= __d<span class="variable-linewrap"><img src="crarr.png" alt="\" /></span>
elACmappingFlag, doc= &quot;mapping flag for AttCert requests to an AA&quot;)
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ndg-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >NDG Security</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    <a href="epydoc-log.html">Generated by Epydoc
    3.0.1 on Thu Sep  4 09:37:43 2008</a>
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
